# MLOps ДЗ-1: Python пакет с C++ биндингами

Проект реализует учебный пример численного алгоритма на C++ (SVD разложение матрицы) с экспортом в Python через pybind11, сборкой wheel-пакета с помощью scikit-build-core и проверкой в Docker.

## Описание проекта

В качестве целевой функции выбрано сингулярное разложение матрицы (SVD), реализованное на C++ в упрощённом виде для демонстрации биндингов и процесса упаковки нативного кода в Python-пакет.  
C++-код обёрнут в модуль `_svd_core` с помощью pybind11 и собирается в бинарное расширение для CPython 3.10 под Linux x86_64.

Основная цель проекта — показать полный цикл: от реализации алгоритма и CMake-сборки до получения установимого wheel-пакета и его проверки внутри Docker-контейнера.

## Реализованный функционал

- Класс `SVDComputer` с методом `compute(matrix)`, принимающим прямоугольную матрицу как список списков чисел с плавающей точкой и возвращающим кортеж `(U, singular_values, Vt)`.
- Упрощённая реализация SVD через вычисление матрицы A^T A и извлечение сингулярных значений по диагонали (учебный вариант, не претендующий на численную оптимальность).
- Экспорт класса `SVDComputer` в Python-модуль `_svd_core` с помощью pybind11.

## Структура репозитория

```
.
├── CMakeLists.txt        — CMake-проект для сборки расширения _svd_core
├── Makefile              — цели: build, install, test, docker-build, docker-test
├── pyproject.toml        — конфигурация сборки на базе scikit-build-core
├── Dockerfile            — образ на python:3.10-slim для сборки и тестов
├── src/
│   ├── svd.hpp           — объявление Matrix, SVDResult и класса SVDComputer
│   └── svd.cpp           — реализация SVD и вспомогательных функций
├── python/
│   └── bindings.cpp      — pybind11-биндинги и определение модуля _svd_core
└── tests/
    └── test_svd.py       — тесты с использованием numpy и scipy.linalg.svd
```

## Сборка и установка локально

Для локальной сборки используется `pyproject.toml` с backend `scikit-build-core` и обёртка в виде Makefile.

Базовые команды:

```bash
# Сборка wheel-пакета и установка
make install

# Запуск тестов (numpy + scipy как эталон)
make test
```

Цель `make install` устанавливает инструменты сборки, вызывает `python3 -m build` для генерации wheel-файла в директории `dist/` и затем устанавливает его через `pip`.

## Запуск и проверка в Docker

Для проверки воспроизводимости и отсутствия скрытых зависимостей используется Dockerfile на основе образа `python:3.10-slim`.

```bash
# Сборка Docker-образа, внутри которого собирается wheel
make docker-build

# Запуск тестов внутри контейнера
make docker-test
```

В образе последовательно выполняются: установка системных инструментов (`build-essential`, `cmake`), сборка wheel-пакета, установка собранного пакета и зависимостей для тестов (`pytest`, `numpy`, `scipy`), затем запуск `pytest`.

## Тестирование

Тесты находятся в `tests/test_svd.py` и запускаются как локально, так и в Docker-контейнере.

Проверяется:

- Корректность базовых свойств сингулярных значений (неотрицательность, сортировка по убыванию).
- Работа на квадратных и прямоугольных матрицах, обработка пустого ввода.
- Сравнение поведения с `scipy.linalg.svd` на нескольких матрицах как с эталонной реализацией.
